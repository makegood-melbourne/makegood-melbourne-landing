---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ServiceTemplatePage from '../../pages/ServiceTemplate.tsx';
import { getPublishedServices, getServiceBySlug } from '../../data/services';

export function getStaticPaths() {
  const services = getPublishedServices();
  return services.map((service) => ({
    params: { slug: service.slug },
    props: { service },
  }));
}

const { slug } = Astro.params;
const service = getServiceBySlug(slug);

if (!service) {
  return Astro.redirect('/capabilities');
}

// Get OG image - use hero image if available, otherwise default
const ogImage = service.heroImage 
  ? `/og/services/${service.slug}.jpg` 
  : '/og-default.jpg';
---

<BaseLayout 
  title={service.metaTitle}
  description={service.metaDescription}
  ogImage={ogImage}
  canonicalUrl={`https://makegood.melbourne/services/${service.slug}`}
>
  <ServiceTemplatePage client:load />
</BaseLayout>
