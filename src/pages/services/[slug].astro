---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ServiceTemplatePage from '../../page-components/ServiceTemplate.tsx';
import { getPublishedServices, getServiceBySlug } from '../../data/services';

export function getStaticPaths() {
  const services = getPublishedServices();
  return services.map((service) => ({
    params: { slug: service.slug },
    props: { service },
  }));
}

const { slug } = Astro.params;
const service = getServiceBySlug(slug);

if (!service) {
  return Astro.redirect('/capabilities');
}
---

<BaseLayout 
  title={service.metaTitle}
  description={service.metaDescription}
  ogImage="/og-default.jpg"
  canonicalUrl={`https://makegood.melbourne/services/${service.slug}`}
>
  <ServiceTemplatePage slug={slug} client:load />
</BaseLayout>
