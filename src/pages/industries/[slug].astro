---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Navigation from '../../components/Navigation';
import IndustryHeroSection from '../../components/IndustryHeroSection.astro';
import IndustryContent from '../../page-components/IndustryContent.tsx';
import CtaBlock from '../../components/CtaBlock.astro';
import Footer from '../../components/Footer';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import { industries, getIndustryBySlug } from '../../data/industries';

export function getStaticPaths() {
  return industries.map((industry) => ({
    params: { slug: industry.slug },
    props: { industry },
  }));
}

const { slug } = Astro.params;
const industry = getIndustryBySlug(slug);

if (!industry) {
  return Astro.redirect('/');
}
---

<BaseLayout 
  title={industry.metaTitle}
  description={industry.metaDescription}
  ogImage={industry.ogImage || "/og-default.jpg"}
  canonicalUrl={`https://makegood.melbourne/industries/${industry.slug}`}
>
  <main class="min-h-screen bg-background text-foreground">
    <Navigation client:load />
    
    <!-- Breadcrumbs (using shared component) -->
    <div class="pt-24 px-4 sm:px-6 lg:px-8">
      <div class="max-w-6xl mx-auto">
        <Breadcrumbs path={`/industries/${slug}`} />
      </div>
    </div>
    
    <!-- Static optimized hero section -->
    <IndustryHeroSection slug={slug} />
    
    <!-- Interactive content loaded after hero -->
    <IndustryContent slug={slug} client:idle />
    
    <!-- Standardized CTA Block -->
    <CtaBlock />
    
    <Footer client:idle />
  </main>
</BaseLayout>
